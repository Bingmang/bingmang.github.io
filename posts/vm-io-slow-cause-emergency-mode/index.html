<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Montserrat:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"bingmang.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"tomorrow-night-bright"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="èµ·å› æœ€è¿‘é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œ åœ¨è™šæ‹Ÿæœºéƒ¨ç½²çš„é›†ç¾¤ä¸Šï¼Œå†å¥—å¨ƒä¸€ä¸ªè™šæ‹Ÿæœºï¼Œå¯¼è‡´ fstab ä¸­æŒ‚è½½ xfs è®¾å¤‡è¶…æ—¶ï¼ŒåŸå› æ˜¯ boot åˆ†åŒºè¢« udev æ‰«ææ—¶ IO å¤ªæ…¢å¯¼è‡´è¶…æ—¶ï¼Œæ‰€ä»¥æ¯æ¬¡å¼€æœºéƒ½ä¼šè¿›å…¥ emergency mode, éœ€è¦æŒ‰ä¸‹ Ctrl + D æ‰èƒ½ç»§ç»­ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="è™šæ‹Ÿæœº IO æ…¢é€Ÿå¯¼è‡´æŒ‚è½½è¶…æ—¶è¿›å…¥ emergency mode é—®é¢˜æ’æŸ¥">
<meta property="og:url" content="https://bingmang.github.io/posts/vm-io-slow-cause-emergency-mode/index.html">
<meta property="og:site_name" content="Mingfei&#39;s Blog">
<meta property="og:description" content="èµ·å› æœ€è¿‘é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œ åœ¨è™šæ‹Ÿæœºéƒ¨ç½²çš„é›†ç¾¤ä¸Šï¼Œå†å¥—å¨ƒä¸€ä¸ªè™šæ‹Ÿæœºï¼Œå¯¼è‡´ fstab ä¸­æŒ‚è½½ xfs è®¾å¤‡è¶…æ—¶ï¼ŒåŸå› æ˜¯ boot åˆ†åŒºè¢« udev æ‰«ææ—¶ IO å¤ªæ…¢å¯¼è‡´è¶…æ—¶ï¼Œæ‰€ä»¥æ¯æ¬¡å¼€æœºéƒ½ä¼šè¿›å…¥ emergency mode, éœ€è¦æŒ‰ä¸‹ Ctrl + D æ‰èƒ½ç»§ç»­ã€‚">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-08-15T07:45:16.000Z">
<meta property="article:modified_time" content="2025-12-16T11:51:18.145Z">
<meta property="article:author" content="Finn Gao">
<meta property="article:tag" content="linux">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://bingmang.github.io/posts/vm-io-slow-cause-emergency-mode/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://bingmang.github.io/posts/vm-io-slow-cause-emergency-mode/","path":"/posts/vm-io-slow-cause-emergency-mode/","title":"è™šæ‹Ÿæœº IO æ…¢é€Ÿå¯¼è‡´æŒ‚è½½è¶…æ—¶è¿›å…¥ emergency mode é—®é¢˜æ’æŸ¥"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>è™šæ‹Ÿæœº IO æ…¢é€Ÿå¯¼è‡´æŒ‚è½½è¶…æ—¶è¿›å…¥ emergency mode é—®é¢˜æ’æŸ¥ | Mingfei's Blog</title>
  








  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Mingfei's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Mingfei's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Don't panic.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B5%B7%E5%9B%A0"><span class="nav-number">1.</span> <span class="nav-text">èµ·å› </span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B0%9D%E8%AF%95%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="nav-number">2.</span> <span class="nav-text">å°è¯•çš„è§£å†³æ–¹æ¡ˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#fstab-%E6%B7%BB%E5%8A%A0-x-systemd-mount-timeout"><span class="nav-number">2.1.</span> <span class="nav-text">fstab æ·»åŠ  x-systemd.mount-timeout</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fstab-%E6%B7%BB%E5%8A%A0-nofail-x-systemd-device-timeout-1ms"><span class="nav-number">2.2.</span> <span class="nav-text">fstab æ·»åŠ  nofail,x-systemd.device-timeout&#x3D;1ms</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fstab-%E6%B7%BB%E5%8A%A0-netdev"><span class="nav-number">2.3.</span> <span class="nav-text">fstab æ·»åŠ  _netdev</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%9D%E8%AF%95-nofail-x-systemd-device-timeout-0"><span class="nav-number">2.4.</span> <span class="nav-text">å°è¯• nofail, x-systemd.device-timeout&#x3D;0</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">2.5.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99"><span class="nav-number">3.</span> <span class="nav-text">å­¦ä¹ èµ„æ–™</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Finn Gao"
      src="/images/red-maple-leaf.png">
  <p class="site-author-name" itemprop="name">Finn Gao</p>
  <div class="site-description" itemprop="description">Live in the moment. AOW / SRE / Observability / AI Agents ğŸ§˜â€â™‚ï¸ğŸƒâ€â™‚ï¸ğŸ®ğŸ¤¿</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/bingmang" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;bingmang" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ustbbingmang@gmail.com" title="E-Mail â†’ mailto:ustbbingmang@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/open0slo" title="Twitter â†’ https:&#x2F;&#x2F;twitter.com&#x2F;open0slo" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS â†’ &#x2F;atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://bingmang.github.io/posts/vm-io-slow-cause-emergency-mode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/red-maple-leaf.png">
      <meta itemprop="name" content="Finn Gao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mingfei's Blog">
      <meta itemprop="description" content="Live in the moment. AOW / SRE / Observability / AI Agents ğŸ§˜â€â™‚ï¸ğŸƒâ€â™‚ï¸ğŸ®ğŸ¤¿">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="è™šæ‹Ÿæœº IO æ…¢é€Ÿå¯¼è‡´æŒ‚è½½è¶…æ—¶è¿›å…¥ emergency mode é—®é¢˜æ’æŸ¥ | Mingfei's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          è™šæ‹Ÿæœº IO æ…¢é€Ÿå¯¼è‡´æŒ‚è½½è¶…æ—¶è¿›å…¥ emergency mode é—®é¢˜æ’æŸ¥
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-08-15 15:45:16" itemprop="dateCreated datePublished" datetime="2021-08-15T15:45:16+08:00">2021-08-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-12-16 19:51:18" itemprop="dateModified" datetime="2025-12-16T19:51:18+08:00">2025-12-16</time>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h1><p>æœ€è¿‘é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œ åœ¨è™šæ‹Ÿæœºéƒ¨ç½²çš„é›†ç¾¤ä¸Šï¼Œå†å¥—å¨ƒä¸€ä¸ªè™šæ‹Ÿæœºï¼Œå¯¼è‡´ fstab ä¸­æŒ‚è½½ xfs è®¾å¤‡è¶…æ—¶ï¼ŒåŸå› æ˜¯ boot åˆ†åŒºè¢« udev æ‰«ææ—¶ IO å¤ªæ…¢å¯¼è‡´è¶…æ—¶ï¼Œæ‰€ä»¥æ¯æ¬¡å¼€æœºéƒ½ä¼šè¿›å…¥ emergency mode, éœ€è¦æŒ‰ä¸‹ Ctrl + D æ‰èƒ½ç»§ç»­ã€‚</p>
<span id="more"></span>

<p>é¦–å…ˆçœ‹ä¸€ä¸‹ fstab çš„é…ç½®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UUID=/dev/mapper/centos-root /                       xfs     defaults        0 0</span><br><span class="line">UUID=9a8652ca-8fa7-4c8a-9345-ea3ed07beaa8 /boot                   xfs     defaults        0 0</span><br></pre></td></tr></table></figure>

<p>æŠ¥é”™ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ journalctl -u boot.mount</span><br><span class="line"></span><br><span class="line">-- Reboot --</span><br><span class="line">Aug 15 16:33:50 localhost.localdomain systemd[1]: Dependency failed for /boot.</span><br><span class="line">Aug 15 16:33:50 localhost.localdomain systemd[1]: Job boot.mount/start failed with result &#x27;dependency&#x27;.</span><br><span class="line">Aug 15 16:34:41 localhost.localdomain systemd[1]: Mounting /boot...</span><br><span class="line">Aug 15 16:35:13 localhost.localdomain systemd[1]: Mounted /boot.</span><br></pre></td></tr></table></figure>

<h1 id="å°è¯•çš„è§£å†³æ–¹æ¡ˆ"><a href="#å°è¯•çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="å°è¯•çš„è§£å†³æ–¹æ¡ˆ"></a>å°è¯•çš„è§£å†³æ–¹æ¡ˆ</h1><h2 id="fstab-æ·»åŠ -x-systemd-mount-timeout"><a href="#fstab-æ·»åŠ -x-systemd-mount-timeout" class="headerlink" title="fstab æ·»åŠ  x-systemd.mount-timeout"></a>fstab æ·»åŠ  x-systemd.mount-timeout</h2><p>æœ€å¼€å§‹ä»¥ä¸ºæ˜¯æŒ‚è½½è¶…æ—¶çš„é—®é¢˜ï¼ŒæŒ‚è½½é»˜è®¤çš„è¶…æ—¶æ—¶é—´æ˜¯ 90 ç§’ï¼Œå¦‚æœæ¯”è¿™ä¸ªæ—¶é—´å¤šï¼Œå°±ä¼šæŒ‚è½½å¤±è´¥è¿›å…¥ emergency mode, æ‰€ä»¥å°è¯•é€šè¿‡æ·»åŠ è¯¥å‚æ•°ï¼š</p>
<p><code>x-systemd.mount-timeout</code> æ˜¯åæ¥æ‰è¢«æ”¯æŒçš„ï¼Œéœ€è¦å…ˆçœ‹ä¸€ä¸‹ç³»ç»Ÿçš„ <code>systemd</code> æ˜¯å¦æ”¯æŒè¯¥å‚æ•°ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://github.com/eworm-de/systemd/commit/9a94ff15c46a3d0c966b8972dbd525cbbdac8b03">https://github.com/eworm-de/systemd/commit/9a94ff15c46a3d0c966b8972dbd525cbbdac8b03</a></p>
<p>æŸ¥çœ‹çš„æ–¹å¼å¾ˆç®€å•ï¼Œé€šè¿‡ <code>man systemd.mount</code> æŸ¥çœ‹æ˜¯å¦æœ‰è¯¥å‚æ•°ï¼Œæ²¡æœ‰çš„è¯å°±æ˜¯ä¸æ”¯æŒã€‚</p>
<p>ä¸æ”¯æŒçš„è¯å¯ä»¥é€šè¿‡ç¬¬äºŒç§æ–¹å¼è®¾å®šï¼ˆå‡è®¾å½“å‰æŒ‚è½½ç›˜ä¸º bootï¼‰ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /etc/systemd/system/boot.mount.d</span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt; /etc/systemd/system/boot.mount.d/timeout.conf</span></span><br><span class="line"><span class="string">[Mount]</span></span><br><span class="line"><span class="string">TimeoutSec=600</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<p>è®¾å®šå¯æ¥å—çš„è¶…å¸‚æ—¶é—´ä¸º 10 åˆ†é’Ÿåï¼Œreboot åå‘ç°è¿˜æ˜¯ä¸€æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»ä¸Šé¢çš„æ—¥å¿—çœ‹åˆ°å¹¶ä¸æ˜¯ mount è¿‡ç¨‹å‘ç”Ÿäº†è¶…æ—¶ï¼Œè€Œæ˜¯ <code>Dependency failed for /boot</code>ï¼Œè¿™é‡Œçš„ dependency åˆ°åº•æŒ‡ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>é¦–å…ˆå°è¯•å°† udevadm çš„ log level è°ƒæ•´ä¸º info:</p>
<p><code>udevadm control --log-priority=info</code> åªä¼šä¸´æ—¶ä½œç”¨äºå½“å‰æ­£åœ¨è¿è¡Œçš„ <code>udevd</code>, å¦‚æœè¦æ°¸ä¹…æ›´æ”¹éœ€è¦ä¿®æ”¹ <code>/etc/udev/udev.conf</code> æ–‡ä»¶ã€‚</p>
<p>ç„¶åé‡å¯å <code>journalctl -xb</code>  æŸ¥çœ‹ç³»ç»Ÿå¯åŠ¨æ—¥å¿—ï¼Œå¯ä»¥å‘ç° udev æ˜¯åœ¨ kernel å¯åŠ¨åæ‰åŠ è½½çš„ï¼Œå› ä¸º udev æ˜¯è¿è¡Œåœ¨ç”¨æˆ·æ€çš„ï¼Œä½†æ˜¯åœ¨è¿™é‡Œå¥½åƒæ²¡æœ‰å‘ç°å…³äº udev çš„ä»€ä¹ˆå¼‚å¸¸ä¿¡æ¯ï¼Œå€’æ˜¯çœ‹åˆ°äº† lvm çš„ warning:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Aug 15 16:32:47 localhost lvm: WARNING: Device /dev/vda1 not initialized in udev database even after waiting 10000000 microseconds.</span><br><span class="line">Aug 15 16:33:29 localhost lvm: WARNING: Device /dev/vda1 not initialized in udev database even after waiting 10000000 microseconds.</span><br><span class="line">Aug 15 16:34:23 localhost lvm: WARNING: Device /dev/vda1 not initialized in udev database even after waiting 10000000 microseconds.</span><br></pre></td></tr></table></figure>

<p>åˆ°è¿™é‡Œå°±æ²¡ä¸‹æ–‡äº†ï¼Œæš‚æ—¶ä¸çŸ¥é“è¶…æ—¶çš„ç‚¹åˆ°åº•å‘ç”Ÿåœ¨å“ªé‡Œï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡å…¶ä»–æ–¹å¼ç»•å¼€äº†ã€‚</p>
<h2 id="fstab-æ·»åŠ -nofail-x-systemd-device-timeout-1ms"><a href="#fstab-æ·»åŠ -nofail-x-systemd-device-timeout-1ms" class="headerlink" title="fstab æ·»åŠ  nofail,x-systemd.device-timeout&#x3D;1ms"></a>fstab æ·»åŠ  nofail,x-systemd.device-timeout&#x3D;1ms</h2><p>é¦–å…ˆçœ‹ä¸€ä¸‹  <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/fstab">fstab - ArchWiki (archlinux.org)</a>  ä¸­çš„æè¿°ï¼š</p>
<blockquote>
<p>External devices that are to be mounted when present but ignored if absent may require the nofail option. This prevents errors being reported at boot. The nofail option is best combined with the x-systemd.device-timeout option. This is because the default device timeout is 90 seconds, so a disconnected external device with only nofail will make your boot take 90 seconds longer, unless you reconfigure the timeout as shown. Make sure not to set the timeout to 0, as this translates to infinite timeout.</p>
</blockquote>
<p>nofail å¯ä»¥è®©ç³»ç»Ÿå¯åŠ¨æ—¶æ— è§†æŒ‚è½½å¼‚å¸¸ï¼Œ<code>x-systemd.device-timeout</code> å‚æ•°ä¼šå†³å®šç­‰å¾…çš„æ—¶é—´ï¼Œé»˜è®¤ä¸º 90 ç§’ï¼Œä¹Ÿå°±æ˜¯è¯´å½“æŒ‚è½½å¼‚å¸¸æ—¶æ•´ä¸ªæŒ‚è½½è¿‡ç¨‹ä»ä¼šæŒç»­ 90 ç§’ï¼Œæ‰€ä»¥å½“é…åˆè¯¥å‚æ•° 1ms ä½¿ç”¨åï¼Œç›¸å½“äºæŒ‚è½½æ“ä½œå˜ä¸ºå¼‚æ­¥ï¼Œå½“è¯¥å‚æ•°ä¸º 0 æ—¶ï¼Œè¡¨ç¤ºæŒ‚è½½æ“ä½œä¸ºé˜»å¡ï¼Œç›´åˆ°æˆåŠŸã€‚</p>
<p>å½“ä¿®æ”¹ä¸ºè¿™ä¸ªå‚æ•°åï¼Œreboot åä¸å†è¿›å…¥ emergency mode, ä½†ç³»ç»Ÿå¯åŠ¨åçš„ä¸€æ®µæ—¶é—´å†…ï¼Œ<code>df -h</code> æ˜¯çœ‹ä¸åˆ°æƒ³æŒ‚è½½çš„åˆ†åŒº <code>/boot</code> çš„ï¼Œè¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ‰ä¼šå‡ºç°ï¼ŒæŸ¥çœ‹ç›¸å…³æ—¥å¿—ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ journalctl -u boot.mount</span><br><span class="line"></span><br><span class="line">-- Reboot --</span><br><span class="line">Aug 15 17:29:43 localhost.localdomain systemd[1]: Mounting /boot...</span><br><span class="line">Aug 15 17:29:53 localhost.localdomain systemd[1]: Mounted /boot.</span><br><span class="line"></span><br><span class="line">$ cat /var/log/messages | grep udev</span><br><span class="line"></span><br><span class="line">Aug 15 17:27:50 localhost lvm: WARNING: Device /dev/vda1 not initialized in udev database even after waiting 10000000 microseconds.</span><br><span class="line">Aug 15 17:28:31 localhost lvm: WARNING: Device /dev/vda1 not initialized in udev database even after waiting 10000000 microseconds.</span><br><span class="line">Aug 15 17:29:31 localhost container-storage-setup: WARNING: Device /dev/vda1 not initialized in udev database even after waiting 10000000 microseconds.</span><br></pre></td></tr></table></figure>

<p>æ¯”æ™®é€šæƒ…å†µä¸‹å°‘äº† dependency failed çš„ç›¸å…³æ—¥å¿—ã€‚</p>
<h2 id="fstab-æ·»åŠ -netdev"><a href="#fstab-æ·»åŠ -netdev" class="headerlink" title="fstab æ·»åŠ  _netdev"></a>fstab æ·»åŠ  _netdev</h2><p>è¯¥å‚æ•°å‡ºç°åœ¨ â€œTips and tricksâ€ ä¸€èŠ‚ä¸­ï¼Œå…ˆçœ‹ä¸€ä¸‹æè¿°ï¼š</p>
<blockquote>
<p>The same applies to remote filesystem mounts. If you want them to be mounted only upon access, you will need to use the noauto,x-systemd.automount parameters. In addition, you can use the x-systemd.mount-timeout&#x3D; option to specify how long systemd should wait for the mount command to finish. Also, the _netdev option ensures systemd understands that the mount is network dependent and order it after the network is online.</p>
</blockquote>
<p>è¯¥å‚æ•°å‘Šè¯‰ systemd è¿™æ˜¯ä¸€ä¸ªç½‘ç»œè®¾å¤‡ï¼Œå½“ç³»ç»Ÿç½‘ç»œå¯ç”¨æ—¶æ‰ä¼šè¢«æŒ‚è½½ï¼Œé‚£ä¹ˆå…·ä½“è¡Œä¸ºæ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p>
<p><a target="_blank" rel="noopener" href="http://codingberg.com/linux/systemd_when_to_use_netdev_mount_option">Systemd: When to use _netdev mount option? | Codingberg</a></p>
<p>ä»ä¸Šé¢çš„åšå®¢ä¸­äº†è§£åˆ°ï¼Œä¸€èˆ¬æ˜¯ nfs ä¼šç”¨åˆ°ï¼Œä½†å…¶å®ä¸ç”¨æ˜ç¡®æŒ‡å®šè¿™ä¸ªå‚æ•°ï¼Œå› ä¸º systemd ä¼šè‡ªåŠ¨æ£€æµ‹æ–‡ä»¶ç³»ç»Ÿç±»å‹æ˜¯å¦éœ€è¦ç½‘ç»œã€‚</p>
<p>æ·»åŠ äº†è¯¥å‚æ•°ä»¥åï¼Œè¡Œä¸ºå’Œæ·»åŠ  <code>nofail,x-systemd.device-timeout=1ms</code> ä¸€è‡´ã€‚</p>
<h2 id="å°è¯•-nofail-x-systemd-device-timeout-0"><a href="#å°è¯•-nofail-x-systemd-device-timeout-0" class="headerlink" title="å°è¯• nofail, x-systemd.device-timeout&#x3D;0"></a>å°è¯• nofail, x-systemd.device-timeout&#x3D;0</h2><p>fstab æ–‡æ¡£ä¸­æåˆ°ä¸è¦æŠŠè¿™ä¸ªå‚æ•°è®¾ä¸º 0ï¼Œå¦åˆ™ä¼šæ°¸è¿œç­‰å¾…ä¸‹å»ï¼Œä½†æˆ‘æœŸæœ›çš„å°±æ˜¯å¿½è§†é”™è¯¯ï¼Œå¹¶ä¸”åœ¨æˆåŠŸæŒ‚è½½åå†å¯åŠ¨ç³»ç»Ÿï¼Œå¦‚æœæ— æ³•å¯åŠ¨ï¼Œåˆ™ä»£è¡¨è¯¥ç›˜ä¸å¯ç”¨ï¼Œè¿™æ˜¯æˆ‘æœŸæœ›çš„ç›®æ ‡ï¼Œæ‰€ä»¥å°±æƒ³çœ‹ä¸€ä¸‹è®¾ç½®ä¸º 0 çš„æ•ˆæœæ˜¯ä»€ä¹ˆæ ·çš„ï¼š</p>
<p>ç›¸æ¯”äº <code>x-systemd.device-timeout=1ms</code>ï¼Œç³»ç»Ÿå¯åŠ¨åèƒ½é©¬ä¸Šçœ‹åˆ° <code>/boot</code> åˆ†åŒºï¼Œç¬¦åˆé¢„æœŸã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç”±äºåµŒå¥—è™šæ‹Ÿæœºçš„ IO è¾ƒæ…¢ï¼Œåœ¨ mount è¾ƒå¤§çš„è™šæ‹Ÿå·æ—¶ IO æ—¶é—´è¿‡é•¿å¯¼è‡´å¼€æœºè¿›å…¥äº† Emergency Mode, é€šè¿‡ä¿®æ”¹ fstab çš„æŒ‚è½½è¡Œä¸º <code>nofail,x-systemd.device-timeout=0</code> è§£å†³äº†è¯¥é—®é¢˜ã€‚</p>
<p>è™½ç„¶å¾—åˆ°äº†é¢„æœŸçš„ç»“æœï¼Œä½†ä»ç„¶æ²¡æ‰¾åˆ°æ ¹æºè¶…æ—¶å‘ç”Ÿåœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œè¿™ä¸ª â€œdependencyâ€ åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸Šç­åé—®é—® mentor å§ã€‚</p>
<h1 id="å­¦ä¹ èµ„æ–™"><a href="#å­¦ä¹ èµ„æ–™" class="headerlink" title="å­¦ä¹ èµ„æ–™"></a>å­¦ä¹ èµ„æ–™</h1><ul>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/XFS">XFS</a> : CentOS 7.0 ç”¨äºæ›¿ä»£ ext4 çš„æ—¥è‡³æ–‡ä»¶ç³»ç»Ÿï¼Œç›¸è¾ƒäº ext4 æ›´å¥½åœ°æ”¯æŒå¤§æ–‡ä»¶ï¼Œæ›´é«˜æ•ˆæ”¯æŒå¹¶è¡Œ IO æ“ä½œï¼›</li>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Udev">udev </a> :  Linux kernel è®¾å¤‡ç®¡ç†å™¨ï¼Œç”¨äºåŠ¨æ€ç®¡ç† &#x2F;dev ç›®å½•åº•ä¸‹çš„è®¾å¤‡èŠ‚ç‚¹ï¼›</li>
<li><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/fstab">fstab - ArchWiki</a></li>
<li><a target="_blank" rel="noopener" href="http://cn.linux.vbird.org/linux_basic/0420quota_3.php">é¸Ÿå“¥çš„ Linux ç§æˆ¿èœ â€” Quota, Software RAID, LVM, iSCSI</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/open0slo">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/linux/" rel="tag"># linux</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/posts/2021-summary/" rel="next" title="2021 å¹´åº¦æ€»ç»“">
                  2021 å¹´åº¦æ€»ç»“ <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments disqusjs-container">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Finn Gao</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@3.1.0/dist/browser/styles/disqusjs.css" integrity="sha256-E4RzceSomICFY1PT/yDQrN8DsLSwdScDEiQAevHabp0=" crossorigin="anonymous">

<script class="next-config" data-name="disqusjs" type="application/json">{"enable":true,"api":null,"apikey":"4BbobWwa0gpnTOjZKVCYqE7VVRAvHfEgEUVPFgUkmBI9siaKnhl5UU0trxpNWMZG","shortname":"Finn","js":{"url":"https://cdn.jsdelivr.net/npm/disqusjs@3.1.0/dist/browser/disqusjs.es2015.umd.min.js","integrity":"sha256-gdbBT62HLzqWTnXQED3WQL/ItFCuWsA5gd6dM/wgdiE="}}</script>
<script src="/js/third-party/comments/disqusjs.js" defer></script>

</body>
</html>
